import { DomNode, el } from "@common-module/app";
import {
  AppCompConfig,
  Button,
  ButtonType,
} from "@common-module/app-components";
import { StringUtils } from "@common-module/ts";
import { WalletLoginManager } from "@common-module/wallet-login";
import { AddIcon } from "@gaiaprotocol/svg-icons";
import { TradeMaterialModal } from "gaiaprotocol";
import { formatEther } from "viem";
import GameConfig from "../GameConfig.js";

const iconImages = {
  wood:
    "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAWCAYAAAA1vze2AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFHGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDE5LTA4LTI2VDE0OjAyOjUxKzA5OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAxOS0wOC0yNlQxNDoxMTo1NyswOTowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAxOS0wOC0yNlQxNDoxMTo1NyswOTowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpjMzk3NDRkZC1kOWIw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",
  stone:
    "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAWCAYAAAA1vze2AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFHGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDE5LTA4LTI2VDE0OjAyOjUxKzA5OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAxOS0wOC0yNlQxNDoxMTo0MiswOTowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAxOS0wOC0yNlQxNDoxMTo0MiswOTowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDphZGMzZDU2My01ODdj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",
  iron:
    "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAWCAYAAAA1vze2AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFHGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDE5LTA4LTI2VDE0OjAyOjUxKzA5OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAxOS0wOC0yNlQxNDoxMjowMyswOTowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAxOS0wOC0yNlQxNDoxMjowMyswOTowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpkYzgzN2U0My03ZjVh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",
  ducat:
    "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAWCAYAAAA1vze2AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFHGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDE5LTA4LTI2VDE0OjAyOjUyKzA5OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAxOS0wOC0yNlQxNDoxMTo0OSswOTowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAxOS0wOC0yNlQxNDoxMTo0OSswOTowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo5MDM2YjgxNC00ODE2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",
};

export default class MaterialPanelItem extends DomNode {
  constructor(private type: "wood" | "stone" | "iron" | "ducat") {
    super(".material-panel-item");
    this.loadBalance();
  }

  private async loadBalance() {
    this.clear().append(el("img.icon", { src: iconImages[this.type] }));

    const account = WalletLoginManager.getLoggedInAddress();
    if (account) {
      const loadingSpinner = new AppCompConfig.LoadingSpinner().appendTo(this);
      const balance = await GameConfig.materialContracts[this.type].balanceOf(
        account,
      );
      this.append(
        el(
          ".balance",
          StringUtils.formatNumberWithCommas(formatEther(balance)),
        ),
        new Button(".buy", {
          type: ButtonType.Circle,
          icon: new AddIcon(),
          onClick: () => {
            const modal = new TradeMaterialModal(
              GameConfig.getMaterialAddress(this.type),
            );
            modal.on("traded", () => this.loadBalance());
          },
        }),
      );
      loadingSpinner.remove();
    }
  }
}
